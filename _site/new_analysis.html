<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>universe-report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">universe-report</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./new_analysis.html" aria-current="page"> 
<span class="menu-text">====================================================================</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPREHENSIVE STOCK ANALYSIS SCRIPT</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Purpose: Identify top stocks and generate insights from stock universe data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:data.table':

    between, first, last</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme for all plots</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. DATA LOADING AND CLEANING</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Loading data...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading data...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>stocks <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"data/Universe_merged.csv"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Total stocks loaded: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(stocks)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total stocks loaded: 10902</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Total columns: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">ncol</span>(stocks)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total columns: 101</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display first few rows</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">First few rows:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
First few rows:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(stocks, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Order Symbol                      Name RS Rating            Industry Name
   &lt;int&gt; &lt;char&gt;                    &lt;char&gt;     &lt;int&gt;                   &lt;char&gt;
1:     1      A      Agilent Technologies        78 Medical-Research Eqp/Svc
2:     2     AA                     Alcoa        81        Mining-Metal Ores
3:     3    AAA Alt Access First Priority        32        Finance-ETF / ETN
    Sector EPS Rating 3-Yr EPS Growth Geq 5-Yr EPS Trl 4Q Gtr EPS 4 Yrs Ago
    &lt;char&gt;      &lt;int&gt;                   &lt;char&gt;                       &lt;char&gt;
1: MEDICAL         73                       No                          Yes
2:  MINING         29                       No                          Yes
3:    MISC          0                       No                          Yes
   EPS Trl 4Q Geq EPS Lst Fiscal Yr Funds % Earnings Stability Number of Stocks
                             &lt;char&gt;  &lt;char&gt;             &lt;char&gt;            &lt;int&gt;
1:                              Yes      57                  9               38
2:                              Yes      42                  -               50
3:                              Yes       1                  -             4629
   Ind Group Rank Ind Grp Rnk Last Week Ind Grp Rnk 3 Mo Ago
            &lt;int&gt;                 &lt;int&gt;                &lt;int&gt;
1:             30                    41                  151
2:              3                     3                    5
3:             77                    71                   92
   Ind Grp Rnk 6 Mo Ago % Chg YTD Ind Mkt Val (bil) Current Price Price $ Chg
                  &lt;int&gt;     &lt;num&gt;             &lt;num&gt;         &lt;num&gt;       &lt;num&gt;
1:                  150     10.19             454.2        148.03        0.57
2:                  155      4.34             735.8         39.42       -0.72
3:                   85     -0.04           12901.4         25.07        0.02
   Price % Chg % Off High Vol % Chg vs 50-Day 50-Day Avg Vol (1000s)
        &lt;char&gt;     &lt;char&gt;               &lt;num&gt;                 &lt;char&gt;
1:        0.39      -3.78               -33.7                   1738
2:       -1.79     -17.48                56.6                   6785
3:        0.08      -1.32                40.4                     10
   50-Day Avg $ Vol (1000s) Market Cap (mil) Comp Rating A/D Rating SMR Rating
                     &lt;char&gt;            &lt;num&gt;      &lt;char&gt;     &lt;char&gt;     &lt;char&gt;
1:                   256654          41966.5          93         A-          A
2:                   262840          10206.4          81          B          C
3:                      263             42.6           -          B          -
   Up/Down Vol EPS Lst Rptd EPS Est Cur Qtr % EPS Est Cur Yr %
        &lt;char&gt;       &lt;char&gt;            &lt;char&gt;           &lt;char&gt;
1:         1.8   2025-08-27                 8                5
2:         1.1   2025-10-22               -32              194
3:         1.6            -                 -                -
   EPS Est Next Yr % EPS % Chg Last Qtr (-/+) EPS % Chg 1 Q Ago
              &lt;char&gt;                   &lt;char&gt;            &lt;char&gt;
1:                 8                        4                 7
2:               -23                     -104               144
3:                 -                        0                 0
   EPS % Chg Lst Yr EPS % Chg 1 Yr Ago P/E Ratio Rank in Grp Exchange
             &lt;char&gt;             &lt;char&gt;                &lt;char&gt;   &lt;char&gt;
1:               -3                  4                    48     NYSE
2:              159               -148                    67     NYSE
3:                0                  2                    88     ARCA
   Ind Group RS RS 3-Month Rating   Beta 21 Day ATR % Shares (1000s)
         &lt;char&gt;            &lt;char&gt; &lt;char&gt;       &lt;char&gt;          &lt;int&gt;
1:            A                90   1.04         2.76         283500
2:           A+                93   1.64          5.5         258914
3:            B                35   0.03         0.39           1700
   Price vs 200-Day % Chg 1 Month % Chg 3 Months % Chg 6 Months EPS Surprise
             &lt;char&gt;        &lt;char&gt;         &lt;char&gt;         &lt;char&gt;       &lt;char&gt;
1:             19.9            19             23           38.3          0.1
2:             25.7          26.2           23.7           49.1         85.8
3:              0.2          -0.1            0.3            0.5            -
   Price vs 50-Day Price vs 10-Day Price vs 21-Day Annual Sales (mil)
            &lt;char&gt;          &lt;char&gt;          &lt;char&gt;             &lt;char&gt;
1:            13.7             3.6             5.8               6510
2:            17.9             5.7             9.3              11895
3:             0.1             0.2             0.2                  0
   Sales % Chg Lst Qtr Avg Sales % Chg 2Q 10 Day &gt; 21 Day &gt; 50 Day
                &lt;char&gt;             &lt;char&gt;                    &lt;int&gt;
1:                  10                8.1                        1
2:                   3                3.5                        1
3:                   -                  -                        0
   Volume (1000s) EPS Accel 3 Qtrs Sales Accel 3 Qtrs   IPO Date
            &lt;int&gt;           &lt;char&gt;             &lt;char&gt;     &lt;char&gt;
1:           1135               No                Yes 1999-11-18
2:          10623               No                 No          -
3:             14               No                 No          -
   ETF/Closed-End Fund Number of Funds Incorp Date    ADR    ETF
                &lt;char&gt;          &lt;char&gt;      &lt;char&gt; &lt;char&gt; &lt;char&gt;
1:                  No            2460        1999     No     No
2:                  No             611        2016     No     No
3:                 Yes               1        2020     No    Yes
   EPS % Chg Last Qtr AT Margin Accel Price to Sales Daily Closing Range
               &lt;char&gt;          &lt;char&gt;         &lt;char&gt;               &lt;num&gt;
1:                  4              No           6.18             31.6614
2:                  -              No           0.79             74.5455
3:                  0              No              -             81.2500
   RS Line Within 5% of New High Timeliness Rating Sales % Chg Lst Yr
                           &lt;int&gt;            &lt;char&gt;             &lt;char&gt;
1:                             0                 B                 -5
2:                             0                 C                 13
3:                             0                 C                  -
   Sponsor Rating RS Line New High RS 6-Month Rating 50-Day &gt; 150-Day &gt; 200-Day
           &lt;char&gt;           &lt;char&gt;            &lt;char&gt;                      &lt;int&gt;
1:              C               No                86                          0
2:              D               No                89                          0
3:              -               No                27                          0
   Price to Book P/E Lss 5-Yr Avg Weekly Closing Range Shares in Float (1000s)
          &lt;char&gt;           &lt;char&gt;                &lt;num&gt;                  &lt;char&gt;
1:          7.12              Yes              79.6680                  280665
2:          1.98               No              65.0820                  256324
3:             -              Yes              60.5263                    1700
   EPS % Chg 2 Q Ago EPS % Chg 3 Q Ago Avg EPS % Chg 2Q Avg Sales % Chg 3Q
              &lt;char&gt;            &lt;char&gt;           &lt;char&gt;             &lt;char&gt;
1:                 2                 6              5.6                5.8
2:                 -                 -                -               12.2
3:                 0                 0             -0.1                  -
   EPS % Chg Lst Q Gtr 3-Yr Growth Price vs 150-Day Funds % Increase
                            &lt;char&gt;           &lt;char&gt;           &lt;char&gt;
1:                             Yes             24.3             -1.2
2:                              No               31                0
3:                              No              0.4                0
   % Chg Cur Week        City New CEO 12 Months Enterprise Val (mil)
           &lt;char&gt;      &lt;char&gt;            &lt;char&gt;               &lt;char&gt;
1:           4.31 Santa Clara                No              43678.9
2:           9.59  Pittsburgh                No              11527.8
3:           0.24  El Segundo                No                    -
   Current day's Volume greater than previous 5 days' Volume
                                                       &lt;int&gt;
1:                                                         0
2:                                                         0
3:                                                         0
   Current day's Volume greater than previous 10 days' Volume
                                                        &lt;int&gt;
1:                                                          0
2:                                                          0
3:                                                          0
   Current day's Volume greater than previous 20 days' Volume % Chg 12 Months
                                                        &lt;int&gt;          &lt;char&gt;
1:                                                          0            13.3
2:                                                          0            -6.2
3:                                                          0            -0.2
   Vol % Chg vs 10-Week EPS Due Date    ROE AT Margin
                 &lt;char&gt;       &lt;char&gt; &lt;char&gt;    &lt;char&gt;
1:                -17.4   2025-12-01   26.2      22.4
2:                 80.2   2026-01-21    6.3      -0.2
3:                 26.2            -      -         -</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check data structure</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data structure:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Data structure:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(stocks[, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'data.table' and 'data.frame':  10902 obs. of  20 variables:
 $ Order                           : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Symbol                          : chr  "A" "AA" "AAA" "AAAA" ...
 $ Name                            : chr  "Agilent Technologies" "Alcoa" "Alt Access First Priority" "Amplius Agg Asset" ...
 $ RS Rating                       : int  78 81 32 53 87 45 89 40 70 73 ...
 $ Industry Name                   : chr  "Medical-Research Eqp/Svc" "Mining-Metal Ores" "Finance-ETF / ETN" "Finance-ETF / ETN" ...
 $ Sector                          : chr  "MEDICAL" "MINING" "MISC" "MISC" ...
 $ EPS Rating                      : int  73 29 0 0 0 5 38 5 0 59 ...
 $ 3-Yr EPS Growth Geq 5-Yr        : chr  "No" "No" "No" "No" ...
 $ EPS Trl 4Q Gtr EPS 4 Yrs Ago    : chr  "Yes" "Yes" "Yes" "No" ...
 $ EPS Trl 4Q Geq EPS Lst Fiscal Yr: chr  "Yes" "Yes" "Yes" "No" ...
 $ Funds %                         : chr  "57" "42" "1" "-" ...
 $ Earnings Stability              : chr  "9" "-" "-" "-" ...
 $ Number of Stocks                : int  38 50 4629 4629 4629 184 42 184 4629 17 ...
 $ Ind Group Rank                  : int  30 3 77 77 77 166 74 166 77 150 ...
 $ Ind Grp Rnk Last Week           : int  41 3 71 71 71 159 85 159 71 146 ...
 $ Ind Grp Rnk 3 Mo Ago            : int  151 5 92 92 92 101 108 101 92 81 ...
 $ Ind Grp Rnk 6 Mo Ago            : int  150 155 85 85 85 30 9 30 85 5 ...
 $ % Chg YTD                       : num  10.19 4.34 -0.04 NA 56.24 ...
 $ Ind Mkt Val (bil)               : num  454 736 12901 12901 12901 ...
 $ Current Price                   : num  148 39.4 25.1 27.1 40.5 ...
 - attr(*, ".internal.selfref")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean column names (remove spaces if any)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stocks) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, <span class="fu">names</span>(stocks))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert numeric columns that might be character</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"RS_Rating"</span>, <span class="st">"EPS_Rating"</span>, <span class="st">"Market_Cap_(mil)"</span>, <span class="st">"Current_Price"</span>, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Price_%_Chg"</span>, <span class="st">"%_Off_High"</span>, <span class="st">"Comp_Rating"</span>, <span class="st">"Beta"</span>, </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"ROE"</span>, <span class="st">"P/E_Ratio_Rank_in_Grp"</span>, <span class="st">"%_Chg_YTD"</span>, <span class="st">"%_Chg_1_Month"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"%_Chg_3_Months"</span>, <span class="st">"%_Chg_6_Months"</span>, <span class="st">"%_Chg_12_Months"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(col <span class="cf">in</span> numeric_cols) {</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(col <span class="sc">%in%</span> <span class="fu">names</span>(stocks)) {</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    stocks[, (col) <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">get</span>(col))]</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion
Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion
Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion
Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion
Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion
Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion
Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion
Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion
Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion
Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove ETFs and focus on regular stocks</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>stocks_filtered <span class="ot">&lt;-</span> stocks <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ETF <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">|</span> <span class="fu">is.na</span>(ETF)) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">RS_Rating</span><span class="st">`</span>))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Stocks after filtering (excluding ETFs): %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(stocks_filtered)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Stocks after filtering (excluding ETFs): 6275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. TOP STOCKS IDENTIFICATION - MULTIPLE CRITERIA</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span> , <span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"TOP STOCKS ANALYSIS</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TOP STOCKS ANALYSIS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.1 Top Stocks by Composite Score (RS Rating + EPS Rating + Comp Rating)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Top 20 Stocks by Composite Score ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Top 20 Stocks by Composite Score ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>top_by_composite <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RS_Rating) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(EPS_Rating) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Comp_Rating)) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Composite_Score =</span> (RS_Rating <span class="sc">+</span> EPS_Rating <span class="sc">+</span> Comp_Rating) <span class="sc">/</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Composite_Score)) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, Name, Sector, RS_Rating, EPS_Rating, Comp_Rating, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>         Composite_Score, <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>, Current_Price) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_by_composite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Symbol                    Name     Sector RS_Rating EPS_Rating Comp_Rating
    &lt;char&gt;                  &lt;char&gt;     &lt;char&gt;     &lt;num&gt;      &lt;num&gt;       &lt;num&gt;
 1:    CLS               Celestica  ELECTRNCS        98         99          99
 2:    FIX     Comfort Systems USA   BUILDING        96         99          99
 3:   STRL Sterling Infrastructure   BUILDING        96         99          99
 4:   PLTR   Palantir Technologies   SOFTWARE        96         98          99
 5:   RMBS                  Rambus      CHIPS        95         99          99
 6:    GFI         Gold Fields ADR     MINING        96         97          99
 7:    APH           Amphenol Cl A  ELECTRNCS        93         99          99
 8:   AVGO                Broadcom      CHIPS        93         99          99
 9:    NXT              Nextracker     ENERGY        97         96          98
10:   PBYI      Puma Biotechnology    MEDICAL        94         99          98
11:   PRIM       Primoris Services   BUILDING        95         97          99
12:    SEI     Solaris Energy Infr   CHEMICAL        97         96          98
13:   TTMI        TTM Technologies  ELECTRNCS        97         96          98
14:    AGX                   Argan   BUILDING        94         99          97
15:   FUTU       Futu Holdings ADR    FINANCE        93         99          98
16:   IDCC            InterDigital  ELECTRNCS        96         97          97
17:   IESC            IES Holdings BUSINS SVC        94         98          98
18:    TTI      Tetra Technologies     ENERGY        97         98          95
19:    VRT         Vertiv Holdings    MACHINE        93         98          99
20:   WLDN           Willdan Group   BUILDING        96         95          99
    Symbol                    Name     Sector RS_Rating EPS_Rating Comp_Rating
    Composite_Score Market_Cap_(mil) Current_Price
              &lt;num&gt;            &lt;num&gt;         &lt;num&gt;
 1:        98.66667          34120.8        296.62
 2:        98.00000          34633.9        981.66
 3:        98.00000          11531.2        379.08
 4:        97.66667         438005.5        184.63
 5:        97.66667          11342.5        105.42
 6:        97.33333          36086.4         40.30
 7:        97.00000         163383.6        133.82
 8:        97.00000        1672331.1        354.13
 9:        97.00000          14541.8         98.28
10:        97.00000            263.4          5.23
11:        97.00000           7689.7        142.37
12:        97.00000           3441.3         50.92
13:        97.00000           6069.6         58.75
14:        96.66667           4095.7        296.55
15:        96.66667          24605.0        178.38
16:        96.66667           9769.2        378.62
17:        96.66667           8675.8        436.98
18:        96.66667           1044.9          7.84
19:        96.66667          71137.8        186.06
20:        96.66667           1501.3        102.37
    Composite_Score Market_Cap_(mil) Current_Price</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.2 Top Growth Stocks (High RS Rating + Strong YTD Performance)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Top 20 Growth Stocks ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Top 20 Growth Stocks ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>top_growth <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RS_Rating) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RS_Rating <span class="sc">&gt;=</span> <span class="dv">90</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RS_Rating), <span class="fu">desc</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, Name, Sector, RS_Rating, <span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="st">`</span><span class="at">%_Chg_12_Months</span><span class="st">`</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>, Current_Price) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_growth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Symbol                    Name     Sector RS_Rating %_Chg_YTD
    &lt;char&gt;                  &lt;char&gt;     &lt;char&gt;     &lt;num&gt;     &lt;num&gt;
 1:    RGC    Regencell Bioscience    MEDICAL        99  12130.67
 2:   QMMM      QMMM Holdings Cl A BUSINS SVC        99   9228.13
 3:   DFDV        DeFi Development    FINANCE        99   1896.91
 4:   SUPX    SuperX AI Technology BUSINS SVC        99   1532.00
 5:   ZEPP         Zepp Health ADR   CONSUMER        99   1483.08
 6:    TOI      Oncology Institute    MEDICAL        99   1437.22
 7:   ABVX              Abivax ADR    MEDICAL        99   1139.89
 8:   BETR   Better Home &amp; Finance    FINANCE        99    791.48
 9:   ABVE  Above Food Ingredients AGRICULTRE        99    761.11
10:   NVFY          Nova Lifestyle   CONSUMER        99    742.75
11:   NEGG         Newegg Commerce     RETAIL        99    741.57
12:   SOGP         Sound Group ADR   INTERNET        99    719.82
13:   UAMY  United States Antimony     MINING        99    578.53
14:   NBTX          Nanobiotix ADR    MEDICAL        99    568.99
15:   BMNR BitMine Immersion Techs    FINANCE        99    546.28
16:   TDUP                 ThredUp     RETAIL        99    542.45
17:   OKLO                    Oklo     ENERGY        99    540.84
18:   IREN                    IREN    FINANCE        99    540.53
19:    TMC  TMC the metals company     MINING        99    536.61
20:   PVLA   Palvella Therapeutics    MEDICAL        99    508.33
    Symbol                    Name     Sector RS_Rating %_Chg_YTD
    %_Chg_12_Months Market_Cap_(mil) Current_Price
              &lt;num&gt;            &lt;num&gt;         &lt;num&gt;
 1:         13092.0           7867.1         15.90
 2:          1190.8           6830.4        119.40
 3:          1794.4            354.2         13.85
 4:          1191.1            794.2         61.20
 5:          1110.6            630.6         41.16
 6:          1348.2            444.1          4.75
 7:           768.5           6815.9         90.76
 8:           431.2           1215.9         79.52
 9:           811.9             37.2          4.65
10:           357.3            132.1          5.67
11:           438.1           1294.1         66.72
12:           824.2             87.3         17.79
13:          1780.7           1667.9         12.01
14:           304.2            910.6         19.20
15:          1926.1          14879.9         50.41
16:          1240.4           1055.9          8.93
17:           653.3          20082.2        136.05
18:           580.7          12462.8         62.90
19:           617.4           2897.6          7.13
20:           329.4             96.4         73.00
    %_Chg_12_Months Market_Cap_(mil) Current_Price</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.3 Top Value Stocks (High EPS Rating + Low P/E in Group)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Top 20 Value Stocks ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Top 20 Value Stocks ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>top_value <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(EPS_Rating) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">P/E_Ratio_Rank_in_Grp</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EPS_Rating <span class="sc">&gt;=</span> <span class="dv">80</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">P/E_Ratio_Rank_in_Grp</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(EPS_Rating), <span class="st">`</span><span class="at">P/E_Ratio_Rank_in_Grp</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, Name, Sector, EPS_Rating, <span class="st">`</span><span class="at">P/E_Ratio_Rank_in_Grp</span><span class="st">`</span>, </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>         ROE, <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>, Current_Price) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Symbol                    Name     Sector EPS_Rating P/E_Ratio_Rank_in_Grp
    &lt;char&gt;                  &lt;char&gt;     &lt;char&gt;      &lt;num&gt;                 &lt;num&gt;
 1:   AXON         Axon Enterprise BUSINS SVC         99                     1
 2:   CLMB  Climb Global Solutions     RETAIL         99                     1
 3:    CLS               Celestica  ELECTRNCS         99                     1
 4:   REVG               REV Group   BUILDING         99                     1
 5:   KNSL   Kinsale Capital Group  INSURANCE         99                     6
 6:    CCJ                  Cameco     MINING         99                     7
 7:   PODD                 Insulet    MEDICAL         99                    10
 8:    PEN                Penumbra    MEDICAL         99                    13
 9:   PLMR        Palomar Holdings  INSURANCE         99                    14
10:   PAYS                 Paysign    FINANCE         99                    16
11:    APH           Amphenol Cl A  ELECTRNCS         99                    18
12:    FIX     Comfort Systems USA   BUILDING         99                    20
13:    MDB                 MongoDB   SOFTWARE         99                    20
14:   STRL Sterling Infrastructure   BUILDING         99                    20
15:     BZ             Kanzhun ADR   INTERNET         99                    25
16:   USLM    U.S. Lime &amp; Minerals   BUILDING         99                    25
17:   ANET         Arista Networks   COMPUTER         99                    28
18:   NVMI                    Nova      CHIPS         99                    28
19:   FUTU       Futu Holdings ADR    FINANCE         99                    29
20:   TFPM Triple Flag Prec Metals     MINING         99                    30
    Symbol                    Name     Sector EPS_Rating P/E_Ratio_Rank_in_Grp
      ROE Market_Cap_(mil) Current_Price
    &lt;num&gt;            &lt;num&gt;         &lt;num&gt;
 1:  23.6          57775.0        735.95
 2:  29.0            609.0        131.91
 3:  25.1          34120.8        296.62
 4:  18.7           2968.8         60.84
 5:  29.2           9841.5        422.38
 6:   4.7          38364.0         88.13
 7:  23.7          22589.5        320.91
 8:   7.5           9797.0        252.99
 9:  22.3           3028.5        113.25
10:  13.9            323.4          5.94
11:  26.3         163383.6        133.82
12:  35.0          34633.9        981.66
13:  16.0          27137.9        333.57
14:  28.8          11531.2        379.08
15:  19.2           9783.2         22.14
16:  24.4           3846.7        134.35
17:  33.8         193331.0        153.82
18:  25.6          10144.8        345.06
19:  21.9          24605.0        178.38
20:   6.3           5793.2         28.76
      ROE Market_Cap_(mil) Current_Price</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.4 Top Momentum Stocks (Strong recent performance)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Top 20 Momentum Stocks (3-Month Performance) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Top 20 Momentum Stocks (3-Month Performance) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>top_momentum <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">%_Chg_3_Months</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">%_Chg_3_Months</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, Name, Sector, <span class="st">`</span><span class="at">%_Chg_1_Month</span><span class="st">`</span>, <span class="st">`</span><span class="at">%_Chg_3_Months</span><span class="st">`</span>, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">%_Chg_6_Months</span><span class="st">`</span>, RS_Rating, <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_momentum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Symbol                      Name     Sector %_Chg_1_Month %_Chg_3_Months
    &lt;char&gt;                    &lt;char&gt;     &lt;char&gt;         &lt;num&gt;          &lt;num&gt;
 1:  WRCDF                  Wirecard   SOFTWARE         -99.0        19900.0
 2:  MFLTY             Missfresh ADR     RETAIL           0.0         9900.0
 3:  VIAOY         VIA optronics ADR  ELECTRNCS          34.4         6933.3
 4:   QMMM        QMMM Holdings Cl A BUSINS SVC          25.7         4938.0
 5:   SPRB        Spruce Biosciences    MEDICAL        1495.7         1356.2
 6:   NUAI  New Era Energy &amp; Digital     ENERGY         536.3         1198.5
 7:   BMMJ               Body &amp; Mind   CONSUMER           0.0          900.0
 8:   MOVE                    Movano    MEDICAL        1143.9          824.4
 9:    IBG Innovation Beverage Group ALCOHL/TOB         443.9          529.0
10:   SUPX      SuperX AI Technology BUSINS SVC          11.5          481.7
11:   BETR     Better Home &amp; Finance    FINANCE          18.7          448.4
12:   PTNM                  Pitanium   CONSUMER          20.7          446.8
13:   SLNH           Soluna Holdings  ELECTRNCS         -12.9          430.9
14:   MENS             Jyong Biotech    MEDICAL           7.6          416.1
15:   CELC                  Celcuity    MEDICAL          31.5          405.1
16:   DVLT              Datavault AI  ELECTRNCS         426.2          398.9
17:   VWAV       VisionWave Holdings  AEROSPACE          25.5          398.3
18:   EMPG               Empro Group   CONSUMER          18.6          366.7
19:  LEJUY         Leju Holdings ADR   INTERNET          41.7          363.6
20:   ORBS          Eightco Holdings       MISC         -51.3          349.0
    Symbol                      Name     Sector %_Chg_1_Month %_Chg_3_Months
    %_Chg_6_Months RS_Rating Market_Cap_(mil)
             &lt;num&gt;     &lt;num&gt;            &lt;num&gt;
 1:            0.0         1              0.0
 2:            0.0        19              0.0
 3:         6933.3         1              0.5
 4:        15820.0        99           6830.4
 5:         1169.9        99             75.0
 6:          534.9        99            152.2
 7:           29.0         1              1.5
 8:          -20.3         4              5.8
 9:          420.0        73              9.1
10:          444.0        99            794.2
11:          451.8        99           1215.9
12:             NA        99            239.1
13:          264.4        99             91.9
14:             NA        99           4646.8
15:          542.8        99           3011.0
16:          331.9        99            605.8
17:            2.8        98            166.4
18:             NA        99            144.6
19:          -87.3        11              0.1
20:          468.1        99             19.5
    %_Chg_6_Months RS_Rating Market_Cap_(mil)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.5 Large Cap Leaders (Market Cap &gt; 10B with High Ratings)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Top 15 Large Cap Leaders ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Top 15 Large Cap Leaders ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>large_cap_leaders <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RS_Rating) <span class="sc">&amp;</span> RS_Rating <span class="sc">&gt;=</span> <span class="dv">85</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RS_Rating), <span class="fu">desc</span>(<span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, Name, Sector, RS_Rating, Comp_Rating, <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, ROE) <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(large_cap_leaders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Symbol                    Name    Sector RS_Rating Comp_Rating
    &lt;char&gt;                  &lt;char&gt;    &lt;char&gt;     &lt;num&gt;       &lt;num&gt;
 1:   NBIS       Nebius Group Cl A  SOFTWARE        99          57
 2:   SNDK                 Sandisk  COMPUTER        99          90
 3:     BE            Bloom Energy    ENERGY        99          99
 4:   OKLO                    Oklo    ENERGY        99          85
 5:   BMNR BitMine Immersion Techs   FINANCE        99          49
 6:   RGTI       Rigetti Computing  COMPUTER        99          71
 7:   IREN                    IREN   FINANCE        99          94
 8:   QBTS          D-Wave Quantum  COMPUTER        99          85
 9:   HOOD       Robinhood Markets   FINANCE        98          97
10:    CLS               Celestica ELECTRNCS        98          99
11:   RKLB              Rocket Lab AEROSPACE        98          78
12:   CRDO        Credo Tech Group     CHIPS        98          99
13:   ASTS         AST SpaceMobile   TELECOM        98          76
14:   SATS                EchoStar   TELECOM        98          71
15:   KTOS    Kratos Defense &amp; Sec AEROSPACE        98          94
    Market_Cap_(mil) %_Chg_YTD    ROE
               &lt;num&gt;     &lt;num&gt;  &lt;num&gt;
 1:          27920.5    323.32   -8.0
 2:          27143.1        NA    4.3
 3:          25828.6    396.98   12.1
 4:          20082.2    540.84  -66.1
 5:          14879.9    546.28  -54.5
 6:          12590.6    154.52 -170.2
 7:          12462.8    540.53    6.0
 8:          11055.5    288.69 -736.5
 9:         124227.9    275.17   13.5
10:          34120.8    221.37   25.1
11:          30947.2    153.47  -40.6
12:          26909.4    131.44   21.3
13:          26422.8    249.29 -103.8
14:          21325.5    223.67   -0.6
15:          15390.6    245.64    6.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. SECTOR AND INDUSTRY ANALYSIS</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SECTOR &amp; INDUSTRY INSIGHTS</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SECTOR &amp; INDUSTRY INSIGHTS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.1 Sector Performance Summary</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Sector Performance Summary ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Sector Performance Summary ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>sector_analysis <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Sector)) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sector) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Num_Stocks =</span> <span class="fu">n</span>(),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_RS_Rating =</span> <span class="fu">round</span>(<span class="fu">mean</span>(RS_Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_YTD_Return =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_3Mo_Return =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">%_Chg_3_Months</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Market_Cap =</span> <span class="fu">round</span>(<span class="fu">median</span>(<span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">0</span>),</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Top_Performers =</span> <span class="fu">sum</span>(RS_Rating <span class="sc">&gt;=</span> <span class="dv">90</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Avg_RS_Rating))</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sector_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33  7
   Sector    Num_Stocks Avg_RS_Rating Avg_YTD_Return Avg_3Mo_Return
   &lt;chr&gt;          &lt;int&gt;         &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
 1 MINING           130          84.2          124.            43.9
 2 AEROSPACE         81          68.3           42.2           19.2
 3 CHIPS            103          66.9           28             22.8
 4 COMPUTER          57          62.2           43.7           22.7
 5 UTILITY           90          60.8           18.1            8.1
 6 ELECTRNCS         81          59.5           22.6          108. 
 7 TELECOM          119          55.1           32             14.8
 8 METALS            57          54.9           10.9            6.4
 9 MACHINE          183          54.1           17.7           10.7
10 S&amp;Ls              42          52.6            9.1            3.1
#  23 more rows
#  2 more variables: Median_Market_Cap &lt;dbl&gt;, Top_Performers &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.2 Top Industries by Average RS Rating</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Top 15 Industries by Average RS Rating ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Top 15 Industries by Average RS Rating ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>industry_analysis <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Industry_Name)) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Industry_Name, Sector) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Num_Stocks =</span> <span class="fu">n</span>(),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_RS_Rating =</span> <span class="fu">round</span>(<span class="fu">mean</span>(RS_Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_YTD_Return =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Num_Stocks <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span>  <span class="co"># At least 5 stocks in industry</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Avg_RS_Rating)) <span class="sc">%&gt;%</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(industry_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15  5
   Industry_Name            Sector    Num_Stocks Avg_RS_Rating Avg_YTD_Return
   &lt;chr&gt;                    &lt;chr&gt;          &lt;int&gt;         &lt;dbl&gt;          &lt;dbl&gt;
 1 Mining-Gold/Silver/Gems  MINING            78          88.6          130. 
 2 Telecom-Fiber Optics     TELECOM            8          85.9           67.4
 3 Computer-Data Storage    COMPUTER          10          84.9           73.9
 4 Retail/Whlsle-Jewelry    RETAIL             7          79.3           14.8
 5 Banks-Money Center       BANKS             26          77.6           40.1
 6 Mining-Metal Ores        MINING            52          77.6          115  
 7 Elec-Semiconductor Equip CHIPS             30          77.2           35.3
 8 Bldg-Heavy Construction  BUILDING          25          74.6           57.6
 9 Elec-Scientific/Msrng    ELECTRNCS          8          74.6           27.1
10 Retail-Department Stores RETAIL             5          71             -3.7
11 Telecom-Cable/Satl Eqp   TELECOM           14          70.8           51.3
12 Elec-Contract Mfg        ELECTRNCS         16          68.6           46.8
13 Aerospace/Defense        AEROSPACE         81          68.3           42.2
14 Utility-Electric Power   UTILITY           33          66.6           26.4
15 Machinery-Constr/Mining  MACHINE            8          65.6           24.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. STATISTICAL INSIGHTS</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"KEY STATISTICAL INSIGHTS</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>KEY STATISTICAL INSIGHTS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.1 Distribution of RS Ratings</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- RS Rating Distribution ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- RS Rating Distribution ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>rs_distribution <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">min</span>(RS_Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q1 =</span> <span class="fu">quantile</span>(RS_Rating, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> <span class="fu">median</span>(RS_Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(RS_Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q3 =</span> <span class="fu">quantile</span>(RS_Rating, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">max</span>(RS_Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Elite_Stocks_90_Plus =</span> <span class="fu">sum</span>(RS_Rating <span class="sc">&gt;=</span> <span class="dv">90</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rs_distribution)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Min Q1 Median  Mean Q3 Max Elite_Stocks_90_Plus
1   1 16     45 47.32 81  99                  910</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.2 YTD Performance Statistics</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- YTD Performance Statistics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- YTD Performance Statistics ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>ytd_stats <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Best_Performer =</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Worst_Performer =</span> <span class="fu">round</span>(<span class="fu">min</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Return =</span> <span class="fu">round</span>(<span class="fu">median</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Return =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Positive_Returns =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Negative_Returns =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Winners_Pct =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="dv">1</span>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ytd_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Best_Performer Worst_Performer Median_Return Mean_Return Positive_Returns
1       12130.67            -100          0.73       19.39             3051
  Negative_Returns Winners_Pct
1             2833        51.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.3 Correlation Analysis (Key Metrics)</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Correlation Analysis ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Correlation Analysis ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>cor_data <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RS_Rating, EPS_Rating, Comp_Rating, <span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">%_Chg_3_Months</span><span class="st">`</span>, Beta, ROE) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(cor_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(cor_matrix, <span class="dv">3</span>))</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find strongest correlations with RS_Rating</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Strongest Correlations with RS Rating ---</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  rs_correlations <span class="ot">&lt;-</span> <span class="fu">sort</span>(cor_matrix[<span class="st">"RS_Rating"</span>,], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(rs_correlations, <span class="dv">3</span>))</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               RS_Rating EPS_Rating Comp_Rating %_Chg_YTD %_Chg_3_Months   Beta
RS_Rating          1.000      0.097       0.797     0.234          0.188  0.157
EPS_Rating         0.097      1.000       0.572     0.001         -0.015 -0.053
Comp_Rating        0.797      0.572       1.000     0.172          0.129  0.109
%_Chg_YTD          0.234      0.001       0.172     1.000          0.368  0.008
%_Chg_3_Months     0.188     -0.015       0.129     0.368          1.000  0.028
Beta               0.157     -0.053       0.109     0.008          0.028  1.000
ROE                0.011      0.002       0.013     0.000          0.000 -0.003
                  ROE
RS_Rating       0.011
EPS_Rating      0.002
Comp_Rating     0.013
%_Chg_YTD       0.000
%_Chg_3_Months  0.000
Beta           -0.003
ROE             1.000

--- Strongest Correlations with RS Rating ---
     RS_Rating    Comp_Rating      %_Chg_YTD %_Chg_3_Months           Beta 
         1.000          0.797          0.234          0.188          0.157 
    EPS_Rating            ROE 
         0.097          0.011 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.4 Market Cap Segmentation</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Market Cap Distribution ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Market Cap Distribution ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>market_cap_segments <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cap_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">10000</span> <span class="sc">~</span> <span class="st">"Large Cap (&gt;$10B)"</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">"Mid Cap ($2B-$10B)"</span>,</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">300</span> <span class="sc">~</span> <span class="st">"Small Cap ($300M-$2B)"</span>,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Micro Cap (&lt;$300M)"</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cap_Category) <span class="sc">%&gt;%</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>(),</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_RS_Rating =</span> <span class="fu">round</span>(<span class="fu">mean</span>(RS_Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_YTD_Return =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_ROE =</span> <span class="fu">round</span>(<span class="fu">median</span>(ROE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>)</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(market_cap_segments)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4  5
  Cap_Category          Count Avg_RS_Rating Avg_YTD_Return Median_ROE
  &lt;chr&gt;                 &lt;int&gt;         &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
1 Large Cap (&gt;$10B)      1100          55.1           24.2       15.9
2 Micro Cap (&lt;$300M)     2350          38.3            3.4      -22.9
3 Mid Cap ($2B-$10B)     1163          52.8           38.8       11.8
4 Small Cap ($300M-$2B)  1662          51.1           24.1        6.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. ADVANCED INSIGHTS</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ADVANCED INSIGHTS</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ADVANCED INSIGHTS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.1 Stocks with Acceleration (Improving EPS)</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Stocks with EPS Acceleration (3 Quarters) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Stocks with EPS Acceleration (3 Quarters) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>eps_accelerators <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">EPS_Accel_3_Qtrs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RS_Rating)) <span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RS_Rating)) <span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, Name, Sector, RS_Rating, EPS_Rating, <span class="st">`</span><span class="at">EPS_%_Chg_Last_Qtr</span><span class="st">`</span>,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(eps_accelerators)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Symbol                    Name    Sector RS_Rating EPS_Rating
    &lt;char&gt;                  &lt;char&gt;    &lt;char&gt;     &lt;num&gt;      &lt;num&gt;
 1:    CLS               Celestica ELECTRNCS        98         99
 2:   EGAN                   eGain  SOFTWARE        98         43
 3:   SSRM              SSR Mining    MINING        98         77
 4:   ALNT                 Allient   MACHINE        97         84
 5:   CIEN                   Ciena   TELECOM        97         87
 6:   KRMN         Karman Holdings AEROSPACE        97         79
 7:    SEI     Solaris Energy Infr  CHEMICAL        97         96
 8:  ATEYY           Advantest ADR     CHIPS        96         95
 9:    FIX     Comfort Systems USA  BUILDING        96         99
10:   INDV                Indivior   MEDICAL        96         79
11:   MLCI     Mount Logan Capital   FINANCE        96          0
12:    PGY     Pagaya Technologies  SOFTWARE        96         80
13:   STRL Sterling Infrastructure  BUILDING        96         99
14:   WLDN           Willdan Group  BUILDING        96         95
15:   BTSG  BrightSpring Hlth Svcs   MEDICAL        95         80
16:    HBM         Hudbay Minerals    MINING        95         76
17:    KGC            Kinross Gold    MINING        95         93
18:   SOFI       SoFi Technologies   FINANCE        95         80
19:    BTG                  B2Gold    MINING        94         82
20:    GTX          Garrett Motion      AUTO        94         76
    Symbol                    Name    Sector RS_Rating EPS_Rating
    EPS_%_Chg_Last_Qtr Market_Cap_(mil)
                &lt;char&gt;            &lt;num&gt;
 1:                 54          34120.8
 2:                 13            388.0
 3:               1175           4639.6
 4:                 97            930.5
 5:                 91          25255.9
 6:                233          11134.9
 7:                162           3441.3
 8:                325          86390.1
 9:                102          34633.9
10:                  6           3135.4
11:                -34             99.7
12:                540           2224.7
13:                 41          11531.2
14:                173           1501.3
15:                900           6028.7
16:               1800           6263.4
17:                214          29177.6
18:                700          34738.0
19:                100           6877.8
20:                 58           3424.8
    EPS_%_Chg_Last_Qtr Market_Cap_(mil)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.2 Institutional Favorites (High Fund Ownership)</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Top 15 Institutional Favorites (High Fund %) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Top 15 Institutional Favorites (High Fund %) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>institutional_favs <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Funds_%</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Funds_%</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Funds_%</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Funds_%</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Funds_%</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, Name, Sector, <span class="st">`</span><span class="at">Funds_%</span><span class="st">`</span>, <span class="st">`</span><span class="at">Number_of_Funds</span><span class="st">`</span>, </span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>         RS_Rating, <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
 In argument: `Funds_% = as.numeric(`Funds_%`)`.
Caused by warning:
! NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(institutional_favs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Symbol                     Name     Sector Funds_% Number_of_Funds
    &lt;char&gt;                   &lt;char&gt;     &lt;char&gt;   &lt;num&gt;          &lt;char&gt;
 1:  ANCTF              Couche-Tard     RETAIL      99            1211
 2:   ASTL       Algoma Steel Group     METALS      99             143
 3:   ATUS          Altice USA Cl A    TELECOM      99             262
 4:   BACQ Bleichroeder Acqn I Cl A       MISC      99              32
 5:   BATL            Battalion Oil     ENERGY      99              35
 6:     BV      BrightView Holdings BUSINS SVC      99             324
 7:  BYDDF                  BYD Co.       AUTO      99            2284
 8:    CAR        Avis Budget Group    LEISURE      99             397
 9:   CELH         Celsius Holdings   FOOD/BEV      99             729
10:   CNCK          Coincheck Group    FINANCE      99               7
11:   CRML          Critical Metals     MINING      99              74
12:   CTRI         Centuri Holdings    UTILITY      99             215
13:    CVI               CVR Energy     ENERGY      99             336
14:  CWENA     Clearway Energy Cl A     ENERGY      99             331
15:    CWH       Camping World Cl A     RETAIL      99             277
    RS_Rating Market_Cap_(mil)
        &lt;num&gt;            &lt;num&gt;
 1:        32          50351.7
 2:         6            136.4
 3:        12           1021.7
 4:        80            410.5
 5:         8             21.2
 6:        14           1268.2
 7:        19          36693.5
 8:        88           5525.7
 9:        95          16340.9
10:         5             40.0
11:        99            140.6
12:        48           1884.7
13:        94           3979.0
14:        68           6041.5
15:        19           1710.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.3 High ROE Stocks</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Top 15 Stocks by Return on Equity (ROE) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Top 15 Stocks by Return on Equity (ROE) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>high_roe <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ROE) <span class="sc">&amp;</span> ROE <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(ROE)) <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, Name, Sector, ROE, EPS_Rating, RS_Rating, </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(high_roe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Symbol                      Name     Sector        ROE EPS_Rating RS_Rating
    &lt;char&gt;                    &lt;char&gt;     &lt;char&gt;      &lt;num&gt;      &lt;num&gt;     &lt;num&gt;
 1:    MGA       Magna International       AUTO 13253012.1         54        73
 2:    PBT  Permian Basin Royalty Tr     ENERGY    13202.6         43        92
 3:   STEC      Santech Holdings ADR    FINANCE     5159.3         65        91
 4:   ENIC            Enel Chile ADR    UTILITY     2961.0          5        84
 5:   INBX       Inhibrx Biosciences    MEDICAL     1905.9         18        99
 6:    LYV           Live Nation Ent    LEISURE     1482.0         66        66
 7:   NEXM          NexMetals Mining     MINING     1347.0         12         8
 8:   STFS Star Fashion Culture Cl A BUSINS SVC     1080.2          5         1
 9:    SBR     Sabine Royalty Tr UBI     ENERGY      922.5         60        55
10:   TZOO                 Travelzoo    LEISURE      727.6         60         9
11:     CL         Colgate-Palmolive   CONSUMER      721.6         61        14
12:    HRB                 H&amp;R Block    FINANCE      716.8         89        19
13:   CSBR        Champions Oncology    MEDICAL      559.1          5        56
14:    OGN                   Organon    MEDICAL      529.9         29         8
15:    COR                   Cencora    MEDICAL      472.0         94        82
    Market_Cap_(mil)
               &lt;num&gt;
 1:          13031.2
 2:            839.9
 3:             33.7
 4:           5353.5
 5:            829.8
 6:          36227.1
 7:            104.7
 8:              2.2
 9:           1015.0
10:            110.9
11:          63041.2
12:           6993.4
13:             95.0
14:           2381.3
15:          64504.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.4 Breakout Candidates (Near New Highs)</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Breakout Candidates (Within 5% of New High) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Breakout Candidates (Within 5% of New High) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>breakout_candidates <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">RS_Line_Within_5%_of_New_High</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>         (<span class="st">`</span><span class="at">%_Off_High</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">%_Off_High</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RS_Rating) <span class="sc">&amp;</span> RS_Rating <span class="sc">&gt;=</span> <span class="dv">85</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RS_Rating)) <span class="sc">%&gt;%</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, Name, Sector, RS_Rating, <span class="st">`</span><span class="at">%_Off_High</span><span class="st">`</span>, <span class="st">`</span><span class="at">%_Chg_3_Months</span><span class="st">`</span>,</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(breakout_candidates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Symbol                     Name    Sector RS_Rating %_Off_High
    &lt;char&gt;                   &lt;char&gt;    &lt;char&gt;     &lt;num&gt;      &lt;num&gt;
 1:    AGH Aureus Greenway Holdings   LEISURE        99      -4.50
 2:   ANRO        Alto Neuroscience   MEDICAL        99      -9.76
 3:   CELC                 Celcuity   MEDICAL        99     -14.49
 4:   CIFR            Cipher Mining   FINANCE        99      -6.09
 5:   DVLT             Datavault AI ELECTRNCS        99      10.32
 6:   EMPG              Empro Group  CONSUMER        99      -4.30
 7:   GRAL                    GRAIL   MEDICAL        99     -13.21
 8:   INBX      Inhibrx Biosciences   MEDICAL        99      45.89
 9:   INTG               InterGroup  REAL EST        99      -3.65
10:    JFU                   9F ADR   FINANCE        99     -11.22
11:    KOD          Kodiak Sciences   MEDICAL        99      -7.17
12:   NVFY           Nova Lifestyle  CONSUMER        99      -6.74
13:   SNDK                  Sandisk  COMPUTER        99      10.84
14:    TOI       Oncology Institute   MEDICAL        99      -1.04
15:   VSAT                   ViaSat   TELECOM        99      -1.45
16:   AIRS   AirSculpt Technologies   MEDICAL        98      -0.44
17:   AVTX       Avalo Therapeutics   MEDICAL        98      -9.48
18:   AXTI                      AXT     CHIPS        98       6.88
19:    BNR Burning Rock Biotech ADR   MEDICAL        98      17.39
20:    CLS                Celestica ELECTRNCS        98      -0.08
    Symbol                     Name    Sector RS_Rating %_Off_High
    %_Chg_3_Months Market_Cap_(mil)
             &lt;num&gt;            &lt;num&gt;
 1:          315.2            111.6
 2:          257.1            297.8
 3:          405.1           3011.0
 4:          210.7           8125.2
 5:          398.9            605.8
 6:          366.7            144.6
 7:          125.1           3222.2
 8:          148.3            829.8
 9:          270.9             88.2
10:          203.5             61.5
11:          126.5            986.1
12:          180.7            132.1
13:          342.6          27143.1
14:           30.1            444.1
15:          163.4           5116.7
16:           81.1            711.1
17:          165.0            231.1
18:          155.7            279.5
19:           56.0            134.8
20:           80.9          34120.8
    %_Chg_3_Months Market_Cap_(mil)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.5 Sector Concentration of Top Performers</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Sector Distribution of Elite Stocks (RS &gt;= 90) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Sector Distribution of Elite Stocks (RS &gt;= 90) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>elite_sector_dist <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RS_Rating <span class="sc">&gt;=</span> <span class="dv">90</span>) <span class="sc">%&gt;%</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sector) <span class="sc">%&gt;%</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Elite_Count =</span> <span class="fu">n</span>(),</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_RS =</span> <span class="fu">round</span>(<span class="fu">mean</span>(RS_Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_YTD =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Elite_Count))</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(elite_sector_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32  4
   Sector     Elite_Count Avg_RS Avg_YTD
   &lt;chr&gt;            &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;
 1 MEDICAL            244   94.9   174. 
 2 MINING              85   95     172. 
 3 ENERGY              51   95.3   122. 
 4 SOFTWARE            51   95     113. 
 5 FINANCE             45   95.6   214. 
 6 BUSINS SVC          42   94.3   358. 
 7 CHIPS               40   94.4    80.7
 8 MACHINE             37   94.8   101. 
 9 CONSUMER            31   94.9   182. 
10 RETAIL              30   93.8    91.3
#  22 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. VISUALIZATIONS</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"GENERATING VISUALIZATIONS...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GENERATING VISUALIZATIONS...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6.1 RS Rating Distribution</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stocks_filtered <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RS_Rating)), </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> RS_Rating)) <span class="sc">+</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">90</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of RS Ratings"</span>,</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Red line indicates elite threshold (RS &gt;= 90)"</span>,</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"RS Rating"</span>,</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Stocks"</span>) <span class="sc">+</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
 Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"outputs/rs_rating_distribution.png"</span>, p1, </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 6.2 Sector Performance Comparison</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>sector_plot_data <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Sector) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sector) <span class="sc">%&gt;%</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_YTD =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>()</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Count <span class="sc">&gt;=</span> <span class="dv">10</span>)</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sector_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Sector, Avg_YTD), <span class="at">y =</span> Avg_YTD)) <span class="sc">+</span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"coral"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average YTD Performance by Sector"</span>,</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Sectors with at least 10 stocks"</span>,</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sector"</span>,</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average YTD Return (%)"</span>) <span class="sc">+</span></span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>)</span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"outputs/sector_performance.png"</span>, p2, </span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 6.3 Scatter Plot: RS Rating vs YTD Performance</span></span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a>scatter_data <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RS_Rating) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">300</span>)  <span class="co"># Focus on companies &gt; 300M</span></span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scatter_data, <span class="fu">aes</span>(<span class="at">x =</span> RS_Rating, <span class="at">y =</span> <span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb127-33"><a href="#cb127-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Sector, <span class="at">size =</span> <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb127-34"><a href="#cb127-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb127-35"><a href="#cb127-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">name =</span> <span class="st">"Market Cap (M)"</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>),</span>
<span id="cb127-36"><a href="#cb127-36" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb127-37"><a href="#cb127-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RS Rating vs YTD Performance"</span>,</span>
<span id="cb127-38"><a href="#cb127-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Stocks with Market Cap &gt; $300M"</span>,</span>
<span id="cb127-39"><a href="#cb127-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"RS Rating"</span>,</span>
<span id="cb127-40"><a href="#cb127-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"YTD Return (%)"</span>) <span class="sc">+</span></span>
<span id="cb127-41"><a href="#cb127-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb127-42"><a href="#cb127-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb127-43"><a href="#cb127-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-44"><a href="#cb127-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"outputs/rs_vs_ytd_scatter.png"</span>, p3, </span>
<span id="cb127-45"><a href="#cb127-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6.4 Top 10 Sectors by RS Rating</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>top_sectors <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Sector) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(RS_Rating)) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sector) <span class="sc">%&gt;%</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_RS =</span> <span class="fu">mean</span>(RS_Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>()</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Count <span class="sc">&gt;=</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Avg_RS)) <span class="sc">%&gt;%</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(top_sectors, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Sector, Avg_RS), <span class="at">y =</span> Avg_RS)) <span class="sc">+</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Avg_RS, <span class="dv">1</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Sectors by Average RS Rating"</span>,</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Sectors with at least 15 stocks"</span>,</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sector"</span>,</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average RS Rating"</span>) <span class="sc">+</span></span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"outputs/top_sectors_rs.png"</span>, p4, </span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 6.5 Market Cap Distribution</span></span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a>cap_dist_data <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Log_Market_Cap =</span> <span class="fu">log10</span>(<span class="st">`</span><span class="at">Market_Cap_(mil)</span><span class="st">`</span>))</span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cap_dist_data, <span class="fu">aes</span>(<span class="at">x =</span> Log_Market_Cap)) <span class="sc">+</span></span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">40</span>, <span class="at">fill =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Market Capitalization (Log Scale)"</span>,</span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Market Cap (Log10 of Millions)"</span>,</span>
<span id="cb129-36"><a href="#cb129-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Stocks"</span>) <span class="sc">+</span></span>
<span id="cb129-37"><a href="#cb129-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb129-38"><a href="#cb129-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-39"><a href="#cb129-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"outputs/market_cap_distribution.png"</span>, p5, </span>
<span id="cb129-40"><a href="#cb129-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb129-41"><a href="#cb129-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-42"><a href="#cb129-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 6.6 Correlation Heatmap</span></span>
<span id="cb129-43"><a href="#cb129-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"cor_matrix"</span>) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(cor_matrix)) {</span>
<span id="cb129-44"><a href="#cb129-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">png</span>(<span class="st">"outputs/correlation_heatmap.png"</span>, </span>
<span id="cb129-45"><a href="#cb129-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb129-46"><a href="#cb129-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb129-47"><a href="#cb129-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">addCoef.col =</span> <span class="st">"black"</span>, <span class="at">number.cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb129-48"><a href="#cb129-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb129-49"><a href="#cb129-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Correlation Matrix of Key Metrics"</span>,</span>
<span id="cb129-50"><a href="#cb129-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb129-51"><a href="#cb129-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb129-52"><a href="#cb129-52" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6.7 Performance Comparison: Multiple Timeframes</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>performance_data <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">%_Chg_1_Month</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">%_Chg_3_Months</span><span class="st">`</span>) <span class="sc">&amp;</span> </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">%_Chg_6_Months</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">%_Chg_12_Months</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, <span class="st">`</span><span class="at">%_Chg_1_Month</span><span class="st">`</span>, <span class="st">`</span><span class="at">%_Chg_3_Months</span><span class="st">`</span>, </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">%_Chg_6_Months</span><span class="st">`</span>, <span class="st">`</span><span class="at">%_Chg_12_Months</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Symbol, <span class="at">names_to =</span> <span class="st">"Period"</span>, <span class="at">values_to =</span> <span class="st">"Return"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Period =</span> <span class="fu">factor</span>(Period, </span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"%_Chg_1_Month"</span>, <span class="st">"%_Chg_3_Months"</span>, </span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"%_Chg_6_Months"</span>, <span class="st">"%_Chg_12_Months"</span>),</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1 Month"</span>, <span class="st">"3 Months"</span>, <span class="st">"6 Months"</span>, <span class="st">"12 Months"</span>)))</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(performance_data, <span class="fu">aes</span>(<span class="at">x =</span> Period, <span class="at">y =</span> Return)) <span class="sc">+</span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Stock Performance Distribution Across Timeframes"</span>,</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Time Period"</span>,</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Return (%)"</span>) <span class="sc">+</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"outputs/performance_timeframes.png"</span>, p6, </span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 6.8 Top 20 Stocks Performance Chart</span></span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>top20_perf <span class="ot">&lt;-</span> stocks_filtered <span class="sc">%&gt;%</span></span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Symbol, Name, <span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, Sector)</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(top20_perf, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Symbol, <span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>), </span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> <span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">fill =</span> Sector)) <span class="sc">+</span></span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 20 Stocks by YTD Performance"</span>,</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Stock Symbol"</span>,</span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"YTD Return (%)"</span>) <span class="sc">+</span></span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"outputs/top20_ytd_performers.png"</span>, p7, </span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. EXPORT KEY RESULTS</span></span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"EXPORTING RESULTS...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>EXPORTING RESULTS...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export top stocks lists to CSV</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(top_by_composite, </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"outputs/top_stocks_composite.csv"</span>, </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(top_growth, </span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">"outputs/top_growth_stocks.csv"</span>, </span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(top_value, </span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">"outputs/top_value_stocks.csv"</span>, </span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(top_momentum, </span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">"outputs/top_momentum_stocks.csv"</span>, </span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(large_cap_leaders, </span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>          <span class="st">"outputs/large_cap_leaders.csv"</span>, </span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sector_analysis, </span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>          <span class="st">"outputs/sector_analysis.csv"</span>, </span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(industry_analysis, </span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a>          <span class="st">"outputs/industry_analysis.csv"</span>, </span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. SUMMARY REPORT</span></span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a><span class="co"># ====================================================================</span></span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-34"><a href="#cb137-34" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ANALYSIS COMPLETE!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANALYSIS COMPLETE!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Key Findings Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Key Findings Summary:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Total stocks analyzed: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(stocks_filtered)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Total stocks analyzed: 6275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Elite stocks (RS &gt;= 90): %d (%.1f%%)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>(stocks_filtered<span class="sc">$</span>RS_Rating <span class="sc">&gt;=</span> <span class="dv">90</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>            <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(stocks_filtered<span class="sc">$</span>RS_Rating <span class="sc">&gt;=</span> <span class="dv">90</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">nrow</span>(stocks_filtered)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Elite stocks (RS &gt;= 90): 910 (14.5%)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Average RS Rating: %.1f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">mean</span>(stocks_filtered<span class="sc">$</span>RS_Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Average RS Rating: 47.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Median YTD Return: %.1f%%</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">median</span>(stocks_filtered<span class="sc">$</span><span class="st">`</span><span class="at">%_Chg_YTD</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Median YTD Return: 0.7%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Number of sectors: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">length</span>(<span class="fu">unique</span>(stocks_filtered<span class="sc">$</span>Sector[<span class="sc">!</span><span class="fu">is.na</span>(stocks_filtered<span class="sc">$</span>Sector)]))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Number of sectors: 33</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Output files generated:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Output files generated:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CSV Files:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CSV Files:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - top_stocks_composite.csv</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - top_stocks_composite.csv</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - top_growth_stocks.csv</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - top_growth_stocks.csv</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - top_value_stocks.csv</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - top_value_stocks.csv</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - top_momentum_stocks.csv</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - top_momentum_stocks.csv</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - large_cap_leaders.csv</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - large_cap_leaders.csv</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - sector_analysis.csv</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - sector_analysis.csv</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - industry_analysis.csv</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - industry_analysis.csv</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Visualization Files:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Visualization Files:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - rs_rating_distribution.png</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - rs_rating_distribution.png</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - sector_performance.png</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - sector_performance.png</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - rs_vs_ytd_scatter.png</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - rs_vs_ytd_scatter.png</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - top_sectors_rs.png</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - top_sectors_rs.png</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - market_cap_distribution.png</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - market_cap_distribution.png</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - correlation_heatmap.png</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - correlation_heatmap.png</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - performance_timeframes.png</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - performance_timeframes.png</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - top20_ytd_performers.png</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - top20_ytd_performers.png</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Analysis completed successfully!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis completed successfully!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>